

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Movimiento de muchas partículas &mdash; Notas de Modelación y Simulación</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/translations.js"></script>
    <link rel="top" title="Notas de Modelación y Simulación" href="../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li><a href="../../index.html">Notas de Modelación y Simulación</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Contenidos</a></h3>
  <ul>
<li><a class="reference internal" href="#">Movimiento de muchas partículas</a><ul>
<li><a class="reference internal" href="#adicion-de-mas-particulas-a-la-simulacion">Adición de más partículas a la simulación</a></li>
<li><a class="reference internal" href="#interaccion-con-otras-particulas">Interacción con otras partículas</a><ul>
<li><a class="reference internal" href="#colisiones">1. Colisiones</a></li>
<li><a class="reference internal" href="#fuerzas-con-otras-particulas">2. Fuerzas con otras partículas</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="movimiento-de-muchas-particulas">
<h1>Movimiento de muchas partículas<a class="headerlink" href="#movimiento-de-muchas-particulas" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="section" id="adicion-de-mas-particulas-a-la-simulacion">
<h2>Adición de más partículas a la simulación<a class="headerlink" href="#adicion-de-mas-particulas-a-la-simulacion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Para simular el movimiento de muchas partículas al mismo tiempo, vamos a seguir
el mismo procedimiento de la sección anterior. Es decir, sólo vamos a cambiar
los valores de las posiciones, velocidades y aceleraciones <em>iniciales</em>,
mientras que dejamos lo demás exactamente como estaba, pues los arreglos de
Numpy se van a encargar de hacerlo todo por nosotros.</p>
<p>Por ejemplo, para simular el movimiento de dos partículas, vamos a definir
estos valores como:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">p0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">a0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
<p>Lo que vemos es que ahora cada arreglo se compone de dos sub-arreglos, el
primero de los cuales corresponde a la posición, velocidad y aceleración de la
primera partícula, mientras que el segundo corresponde a los mismos valores
pero de la segunda partícula.</p>
<p>Esto quiere decir que la posición inicial de la primera partícula está en el
punto con coordenadas <img class="math" src="../../_images/math/dbb8858b7eefd40608ac2c33f75f1c80b800bc74.png" alt="(1, 5)"/> y que la velocidad de la segunda partícula
es sólo horizontal, con un valor de -2 m/s. lo que nos dice que se está
moviendo hacia la izquierda.</p>
<p><strong>Ejercicios</strong></p>
<ol class="arabic">
<li><p class="first">Definir una constante <tt class="docutils literal"><span class="pre">N</span></tt> para guardar el número de partículas a simular
en el sistema. En este caso, hacer:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">N</span> <span class="o">=</span> <span class="mi">2</span>   <span class="c"># Número de partículas</span>
</pre></div>
</div>
</li>
<li><p class="first">Cambiar los valores de <tt class="docutils literal"><span class="pre">p0</span></tt>, <tt class="docutils literal"><span class="pre">v0</span></tt> y <tt class="docutils literal"><span class="pre">a0</span></tt> en el programa anterior, por
los valores dados arriba.</p>
</li>
<li><p class="first">Colocar dentro de un ciclo <tt class="docutils literal"><span class="pre">for</span></tt>, que vaya desde <tt class="docutils literal"><span class="pre">0</span></tt> hasta <tt class="docutils literal"><span class="pre">N</span></tt>, la
función <tt class="docutils literal"><span class="pre">colision_muros</span></tt>, para revisar si alguna de las partículas se está
chocando los muros.</p>
</li>
<li><p class="first">Generar una animación en VPython del fenómeno anterior, siguiendo para ello
estos pasos:</p>
<ul>
<li><p class="first">Con un ciclo <tt class="docutils literal"><span class="pre">for</span></tt> generar una lista llamada <tt class="docutils literal"><span class="pre">particulas</span></tt> para guardar
las <tt class="docutils literal"><span class="pre">N</span></tt> partículas que se está intentando simular. Cada una de ellas va
a estar definida en términos de <tt class="docutils literal"><span class="pre">vis.cylinder</span></tt> (como se hizo en la
<a class="reference internal" href="Movimiento en dos dimensiones.html#particula-cylinder"><em>sección anterior</em></a>), y sus posiciones iniciales
son cada uno de los valores de <tt class="docutils literal"><span class="pre">p0</span></tt>.</p>
</li>
<li><p class="first">Dentro del ciclo <tt class="docutils literal"><span class="pre">for</span></tt> que genera la animación, introducir un nuevo
ciclo <tt class="docutils literal"><span class="pre">for</span></tt> para moverse en la lista <tt class="docutils literal"><span class="pre">partículas</span></tt>.</p>
</li>
<li><p class="first">Dentro de este ciclo <tt class="docutils literal"><span class="pre">for</span></tt>, actualizar la posición de cada partícula
como:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">particulas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">posicion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
<p>donde <tt class="docutils literal"><span class="pre">posicion</span></tt> es un elemento de <tt class="docutils literal"><span class="pre">posiciones</span></tt></p>
</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="interaccion-con-otras-particulas">
<h2>Interacción con otras partículas<a class="headerlink" href="#interaccion-con-otras-particulas" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Al observar la animación generada en el último de los ejercicios anteriores,
puede apreciarse que aunque se está simulando correctamente el movimiento de
cada partícula por separado, aún hace falta tener en cuenta la forma en que una
partícula puede interactuar con las demás.</p>
<p>En esta sección vamos a considerar dos tipos de interacciones:</p>
<div class="section" id="colisiones">
<h3>1. Colisiones<a class="headerlink" href="#colisiones" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La colisión entre dos partículas es similar a la que ocurre entre una partícula
y los muros, en el sentido en que lo único que cambia es la <strong>velocidad</strong> de
las partículas que intervienen en el choque, y no su posición o aceleración. La
diferencia es que, en este caso, el cálculo es mucho más complejo que antes.</p>
<p>Antes de proceder a describir cómo se calcula el choque, es necesario añadir
dos variables más en la sección de constantes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">R</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c"># El radio de las partículas</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c"># La masa de las partículas</span>
</pre></div>
</div>
<p>Ahora bien, para calcular las velocidades que adquieren dos partículas después
de que ha ocurrido una colisión entre ellas, vamos a definir una función
llamada <tt class="docutils literal"><span class="pre">colision_particulas</span></tt> con cuatro argumentos:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">pos1</span></tt>: la posición de la primera partícula</li>
<li><tt class="docutils literal"><span class="pre">pos2</span></tt>: la posición de la segunda partícula</li>
<li><tt class="docutils literal"><span class="pre">vel1</span></tt>: la velocidad de la primera partícula</li>
<li><tt class="docutils literal"><span class="pre">vel2</span></tt>: la velocidad de la segunda partícula</li>
</ul>
</div></blockquote>
<p>Con estos valores vamos a escribir el cuerpo de la función siguiendo estos
pasos:</p>
<ul>
<li><p class="first">Con un <tt class="docutils literal"><span class="pre">if</span></tt> determinar si una partícula se ha chocado con otra.</p>
<p>La condición para que dos partículas se choquen es que la distancia entre sus
centros (que corresponde a la raíz cuadrada de <tt class="docutils literal"><span class="pre">pos1</span> <span class="pre">-</span> <span class="pre">pos2</span></tt>) sea menor que
<tt class="docutils literal"><span class="pre">2*R</span></tt>, donde <tt class="docutils literal"><span class="pre">R</span></tt> es el radio de las partículas.</p>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<ul class="last simple">
<li>Para calcular la distancia, utilizar la función <tt class="docutils literal"><span class="pre">norm</span></tt> de la librería
<tt class="docutils literal"><span class="pre">numpy.linalg</span></tt></li>
<li>Guardar la distancia en una variable llamada <tt class="docutils literal"><span class="pre">d</span></tt>.</li>
</ul>
</div>
</li>
<li><p class="first">Si la condición anterior se cumple, procedemos a calcular los vectores normal
y tangencial entre las dos partículas, de la siguiente forma:</p>
<ul>
<li><p class="first">Definimos una variable <tt class="docutils literal"><span class="pre">vn</span></tt> para guardar el vector normal como</p>
<div class="math">
<p><img src="../../_images/math/63503b88d2e57282323af9ae910012ad3c312925.png" alt="vn = \frac{pos1 - pos2}{d}"/></p>
</div></li>
<li><p class="first">El vector tangencial, <tt class="docutils literal"><span class="pre">vt</span></tt>, se calcula a partir del vector normal como:</p>
<div class="math">
<p><img src="../../_images/math/bc5076ce7396fdb62655717559f9c8fc190d5e6a.png" alt="vt = (-vn_{y},\, vn_{x})"/></p>
</div></li>
</ul>
</li>
<li><p class="first">Una vez calculados estos vectores, se procede a calcular la componente normal
de las velocidades de las partículas, como:</p>
<div class="math">
<p><img src="../../_images/math/84ee04854c7e88059add07cbc4defe2978d9b165.png" alt="vel1n = vel1 \cdot vn

vel2n = vel2 \cdot vn"/></p>
</div><p>donde <img class="math" src="../../_images/math/8f1fb66751f2ee2626c75303485dba473c39a2f2.png" alt="\cdot"/> es el producto punto o escalar entre los dos vectores, y
se puede obtener con la función <tt class="docutils literal"><span class="pre">numpy.dot</span></tt></p>
</li>
<li><p class="first">Con un <tt class="docutils literal"><span class="pre">if</span></tt> determinar que <strong>no</strong> se tenga que el signo de <tt class="docutils literal"><span class="pre">vel1n</span></tt> sea
igual a <tt class="docutils literal"><span class="pre">1</span></tt> <strong>y</strong> el de <tt class="docutils literal"><span class="pre">vel2n</span></tt> sea igual a <tt class="docutils literal"><span class="pre">-1</span></tt>. Si se tiene este
caso, quiere decir que las partículas se están moviendo en direcciones
opuestas en el eje normal y que <strong>no</strong> van a colisionar.</p>
<p>Para revisar el signo de un número, utilizar la función <tt class="docutils literal"><span class="pre">np.sign</span></tt>. Todo lo
que sigue debe estar dentro de este <tt class="docutils literal"><span class="pre">if</span></tt>.</p>
</li>
<li><p class="first">Después se calculan las componentes tangenciales de <tt class="docutils literal"><span class="pre">vel1</span></tt> y <tt class="docutils literal"><span class="pre">vel2</span></tt> como:</p>
<div class="math">
<p><img src="../../_images/math/0cb103aadc4242cb3987519ba43a11a22f56322d.png" alt="vel1t = vel1 \cdot vt

vel2t = vel2 \cdot vt"/></p>
</div></li>
<li><p class="first">Con estos valores se calculan las velocidades después del choque como:</p>
<div class="math">
<p><img src="../../_images/math/f6fed782bebd0079b3f617c69d08aec6c5e79493.png" alt="nueva\_vel1 = \left( \frac{vel1n * (m1 - m2) + 2 * m2 * vel2n}{m1 + m2}
              \right) vn + vel1t * vt

nueva\_vel2 = \left( \frac{vel2n * (m2 - m1) + 2 * m1 * vel1n}{m1 + m2}
              \right) vn + vel1t * vt"/></p>
</div><p>donde <img class="math" src="../../_images/math/cf4ac1bd873fc56f73d5291db98744bfaac83090.png" alt="m1"/> y <img class="math" src="../../_images/math/0ebdb1edea8dbfd5ec26540d0b8b7c6dbce948e5.png" alt="m2"/> son las masas de la partícula 1 y de la 2,
respectivamente. Por sencillez vamos a asumir que estos dos valores son
iguales a la constante <tt class="docutils literal"><span class="pre">m</span></tt> definida arriba.</p>
</li>
<li><p class="first">Finalmente, hacer que la función retorne una tupla compuesta de
<tt class="docutils literal"><span class="pre">nueva_vel1</span></tt> y <tt class="docutils literal"><span class="pre">nueva_vel2</span></tt>.</p>
<p>En caso de que el <tt class="docutils literal"><span class="pre">if</span></tt> inicial no se cumpla, hacer que la función retorne
los valores originales de <tt class="docutils literal"><span class="pre">vel1</span></tt> y <tt class="docutils literal"><span class="pre">vel2</span></tt>.</p>
</li>
</ul>
<p><strong>Ejercicios</strong></p>
<ol class="arabic simple">
<li>Añadir <tt class="docutils literal"><span class="pre">colision_particulas</span></tt> al algoritmo de Verlet por medio de estos
pasos:<ul>
<li>Dentro del ciclo <tt class="docutils literal"><span class="pre">for</span></tt> que calcula Verlet, añadir un nuevo <tt class="docutils literal"><span class="pre">for</span></tt> con
un contador <tt class="docutils literal"><span class="pre">i</span></tt> que vaya desde <tt class="docutils literal"><span class="pre">0</span></tt> hasta <tt class="docutils literal"><span class="pre">N</span></tt>, para recorrer la lista
de partículas.</li>
<li>Dentro de éste, definir otro <tt class="docutils literal"><span class="pre">for</span></tt> con un contador <tt class="docutils literal"><span class="pre">j</span></tt>, que también
vaya de <tt class="docutils literal"><span class="pre">0</span></tt> a <tt class="docutils literal"><span class="pre">N</span></tt>, para revisar las posibles colisiones entre <tt class="docutils literal"><span class="pre">i</span></tt> y
<tt class="docutils literal"><span class="pre">j</span></tt>.</li>
<li>Con un <tt class="docutils literal"><span class="pre">if</span></tt> revisar que la partícula <tt class="docutils literal"><span class="pre">i</span></tt> no sea igual a la <tt class="docutils literal"><span class="pre">j</span></tt>, y
que <tt class="docutils literal"><span class="pre">i</span></tt> sea menor que <tt class="docutils literal"><span class="pre">j</span></tt>, para no tener que repetir el cálculo de la
colisión dos veces.</li>
<li>Si se cumple este <tt class="docutils literal"><span class="pre">if</span></tt>, llamar la función <tt class="docutils literal"><span class="pre">colision_particulas</span></tt>, con
los valores de <tt class="docutils literal"><span class="pre">nueva_posicion</span></tt> y <tt class="docutils literal"><span class="pre">nueva_velocidad</span></tt> para <tt class="docutils literal"><span class="pre">i</span></tt> y
<tt class="docutils literal"><span class="pre">j</span></tt>.</li>
<li>Asignarle el resultado de <tt class="docutils literal"><span class="pre">colision_particulas</span></tt> a los valores de
<tt class="docutils literal"><span class="pre">nueva_velocidad</span></tt> de <tt class="docutils literal"><span class="pre">i</span></tt> y <tt class="docutils literal"><span class="pre">j</span></tt>.</li>
</ul>
</li>
<li>Generar una animación con VPython para comprobar que todo esté funcionando
correctamente.</li>
<li>Añadir una tercera partícula a la simulación, con posición inicial
<img class="math" src="../../_images/math/c3a4f34156fc5235332aeb21628083a136e8608b.png" alt="(8,7)"/> y velocidad inicial <img class="math" src="../../_images/math/a11af309f4f98a632b52d2972cd9de92053c603c.png" alt="(-1,-1)"/>. ¿Qué variables y/o
funciones es necesario cambiar para ello?</li>
<li>Hacer que la simulación vaya más rápido <strong>sin</strong> modificar <tt class="docutils literal"><span class="pre">vis.rate</span></tt>. ¿Qué
valor define qué tan rápido se mueve una partícula?</li>
</ol>
</div>
<div class="section" id="fuerzas-con-otras-particulas">
<h3>2. Fuerzas con otras partículas<a class="headerlink" href="#fuerzas-con-otras-particulas" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Hay varios tipos de fuerzas que una partícula le puede ejercer a otra, pero en
esta sección sólo vamos a simular una: la fuerza de gravedad entre la Tierra y
un cometa que pasa cerca de ella.</p>
<p>La fuerza de gravedad que un cuerpo <em>1</em> le ejerce a un cuerpo <em>2</em> se calcula
con la fórmula:</p>
<div class="math">
<p><img src="../../_images/math/b6667da6b207b8495970ce8f9967defdd4ec846e.png" alt="\vec{F}_{12} = - G \frac{m_{1}m_{2}}{r_{12}^{2}} \vec{r}_{12}"/></p>
</div><p>donde <img class="math" src="../../_images/math/6e28ce12d49d39f160d5a0ef54077fc98e4b9d2b.png" alt="G"/> es la constante universal de la gravitación, <img class="math" src="../../_images/math/25d659c8074c617549d61db9db0773e0fccad7b3.png" alt="m_1"/> y
<img class="math" src="../../_images/math/ee54e8432d4a60984309e86f32931b04c8e2f1da.png" alt="m_2"/> son las masas de los cuerpos y <img class="math" src="../../_images/math/598c5740d7199ae8297c08e5cb79ca0917eb4b53.png" alt="\vec{r}_{12}"/> es un vector
unitario en la dirección de línea que va desde el centro de la partícula <em>1</em> al
centro de <em>2</em>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li><a href="../../index.html">Notas de Modelación y Simulación</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Carlos Cordoba.
      Creado con <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>